
\chapter{特征值和特征向量}
\section{特征值和特征向量}
\begin{definition}{特征值和特征向量}{eigenvalue and eigenvector}
	给定方阵$A$，若存在$x\neq 0$和$\lambda\in\FF$满足：
	\[
		Ax=\lambda x,
	\]
	则称$x$是$A$的特征向量(eigenvector)，$\lambda$是对应的特征值(eigenvalue)。
	矩阵$A$所有特征值构成的集合称为$A$的谱(spectrum)。
\end{definition}

\begin{corollary}
	特征值的性质：
	\begin{compactenum}
		\item $A$的特征向量$x$也是$A^n$的特征向量，特征值是$\lambda^n;$
		\item 若$A$可逆，则$x$也是$A\iv$的特征向量，特征值是$\lambda^{-1};$
		\item 三角矩阵的特征值就是对角元；
		\item $A$可逆$\iff A$所有特征值非0。
		
		% 只需注意到$A$可逆时$Ax=0$只有零解即可。
	\end{compactenum}
\end{corollary}

\begin{theorem}{不同特征值对应特征向量线性无关}{eigenvalue}
	给定$A$的一组特征向量$x_1,\ldots,x_r$，对应特征值为$\lambda_1,\ldots,\lambda_r$。
	若$\lambda_1,\ldots,\lambda_r$两两不等，则$x_1,\ldots,x_r$线性无关。
\end{theorem}
\begin{proof}
	运用数学归纳法证明。$r=1$时，$x_1\neq 0$自然线性无关；
	
	假设$r=m-1$时，$x_1,\ldots,x_{m-1}$线性无关；当$r=m$时，考虑
	\begin{equation}
		\label{eqn:proof eigen 1}
		x_m=c_1x_1+\cdots+c_{m-1}x_{m-1},\tag{$\ast$}
	\end{equation}
	两边同时左乘$A$得
	\begin{equation}
		\label{eqn:proof eigen 2}
		\lambda_mx_m=c_1\lambda_1x_1+\cdots+c_{m-1}\lambda_{m-1}x_{m-1},\tag{$\ast\ast$}
	\end{equation}
	$\lambda_m$\eqref{eqn:proof eigen 1} $-$ \eqref{eqn:proof eigen 2}得，
	\[
		0=c_1(\lambda_m-\lambda_1)x_1+\cdots+c_{m-1}(\lambda_m-\lambda_{m-1})x_{m-1},
	\]
	由$x_1,\ldots,x_{m-1}$线性无关可得所有的$c_i=0$，故$x_1,\ldots,x_m$线性无关。

	综上，定理对所有可能的$r$均成立。
\end{proof}

\section{特征多项式}

\begin{definition}{特征子空间}{eigen-subspace}
	$A$的所有特征值为$\lambda$的特征向量张成$\RR^n$的一个线性子空间：$\N(A-\lambda I).$
\end{definition}

% \begin{corollary}
% 	如果$\lambda$是$A$的特征值，则$(A-\lambda I)$必然不可逆。
% \end{corollary}

\begin{definition}
	{特征方程和特征多项式}{eigenfunction and eigen-polynomial}
	求特征值$\lambda$需要解特征方程(eigenfunction)：
	\[
		\det(\lambda I-A)=\lambda^n+a_1\lambda^{n-1}+\cdots+a_n=0,
	\]
	而$p_A(\lambda):=\det(\lambda I-A)$称为特征多项式(eigen-polynomial)。
\end{definition}

\begin{corollary}
	特别地，$p_A(0)=a_n=\det(-A)$，由Vieta定理：在考虑重根的情况下，
	\begin{equation}
		\label{eqn:det lambda}
		\det(A)=\prod_{i=1}^n\lambda_i.
	\end{equation}
	另一方面，通过对行列式进行Laplace展开，可得$a_1=-\tr(A)$，由Vieta定理：
	\begin{equation}
		\label{eqn:trace lambda}
		\tr(A)=\sum_{i=1}^n\lambda_i,
	\end{equation}
\end{corollary}

\subsectionstar{Cayley-Hamilton定理}

\begin{theorem}
	{Cayley-Hamilton定理}{Cayley-Hamilton theorem}
	给定特征多项式$p_A$的系数$1,a_1,\ldots,a_n$，可定义矩阵多项式
	\begin{equation}
		p_A^*(X)=X^n+a_1X^{n-1}+\cdots+a_{n-1}X+a_nI,
	\end{equation}
	则$p_A^*(A)=O$。
\end{theorem}

\noindent
\textit{完全错误的证明.}
将特征多项式$p_A(\lambda)=\det(\lambda I-A)$中的$\lambda$替换为$A$，自然得到$p_A(A)=\det(AI-A)=0$。

% \begin{proof}
% 	仅证明$A$的特征向量$x_1,\ldots,x_n$构成$\FF^n$的一组基的情形(即$A$可对角化)，
% 	\begin{align*}
% 		p_A(A)x_i&=A^nx_i+c_{n-1}A^{n-1}x_i+\cdots+c_0x_i\\
% 		&=\lambda_i^2x_i+c_{n-1}\lambda_i^{n-1}x_i+\cdots+c_0x_i=p_A(\lambda)x_i=0,
% 	\end{align*}
% 	故$\forall x\in\FF^n$，都有$p_A(A)x=0$，取$x=e_1,\ldots,e_n$可得$p_A(A)=O$。
% \end{proof}

% \begin{remark}
% 	特征多项式$p_A:\FF\to\FF$与矩阵多项式$p_A^*$是完全不同的两个映射。
% \end{remark}

\begin{proof}
	考察伴随矩阵$\adj(\lambda I-A)$，可以写成如下形式：
	\[
		\adj(\lambda I-A)=B_1\lambda^{n-1}+\cdots+B_{n-1}\lambda+B_n,
	\]
	其中$B_1,\ldots,B_n$完全由$A$决定。
	由伴随矩阵的性质：
	\[
		(\lambda I-A)\adj(\lambda I-A)=\det(\lambda I-A)I=p_A(\lambda)I,
	\]
	两边展开可得
	\[
		B_1\lambda^n+(B_2-AB_1)\lambda^{n-1}+\cdots+(B_n-AB_{n-1})\lambda-AB_n=I\lambda^n+a_1I\lambda^{n-1}+\cdots+a_{n-1}\lambda+a_nI,
	\]
	作为系数的矩阵均由$A$确定，与$\lambda$无关。由于上式$\forall\lambda$均成立，故对应系数相同：
	\[
		B_1=I,\quad
		B_{i+1}-AB_i=a_iI,\quad
		-AB_n=a_nI.
	\]
	因而$p_A^*(A)$可以化为裂项和(telescoping sum)
	\[
		p_A^*(A)=A^nB_1+A^{n-1}(B_2-AB_1)+\cdots+A(B_n-AB_{n-1})-AB_n=O.
		\qedhere
	\]
\end{proof}

\begin{theorem}
	{Faddeev-LeVerrier算法}{Faddeev-LeVerrier algorithm}
	特征多项式$p_A(\lambda)$的第$k$个系数$a_k$可以递归地求出：
	\begin{equation}
		a_k=-\frac1k\bigfkh{\tr(A^k)+a_1\tr(A^{k-1})+\cdots+a_{k-1}\tr(A)}.
		% a_m=-\frac1m\sum_{k=1}^ma_{m-k}\tr(A^k).
	\end{equation}
\end{theorem}

\begin{proof}
	沿用\thmref{thm:Cayley-Hamilton theorem} 证明中的定义，
	% 并额外定义$B_0=O,\enspace c_0=1$。
	% 两边取迹得
	% \[
	% 	(n-i)a_i=\tr(AB_i)+na_i
	% \]
	由Jacobi公式\eqref{eqn:Jacobi det'}，有 
	\[
		p_A'(\lambda)=\tr(\adj(\lambda I-A)I)=\tr(B_1\lambda^{n-1}+\cdots+B_n)
	\]
	展开
	\[
		n\lambda^{n-1}+(n-1)a_1\lambda^{n-2}+\cdots+a_{n-1}=\tr(B_1)\lambda^{n-1}+\tr(B_2)\lambda^{n-2}+\cdots+\tr(B_n).
	\]
	由于上式$\forall\lambda$均成立，故对应系数相同：
	\[
		(n-k)a_k=\tr(B_{k+1}),
	\]
	又$B_k$满足递推关系$B_{k+1}=AB_k+a_kI$，两边取迹可得
	\[
		(n-k)a_k=\tr(AB_k)+na_k,\implies a_k=-\frac1k\tr(AB_k),
	\]
	再展开$B_k$即证：
	\[
		B_k=AB_{k-1}+a_{k-1}I=\cdots=A^{k-1}+a_1A^{k-2}+\cdots+a_{k-1}I.
		\qedhere
	\]
\end{proof}

\begin{corollary}
	取$\lambda=0$可得伴随矩阵：
	\begin{equation}
		\adj(-A)=B_n=A^{n-1}+a_1A^{n-2}+\cdots+a_{n-1}I.
	\end{equation}
	易证这满足$\adj(-A)(-A)=(-A)\adj(-A)=\det(-A)I=c_0I$。
\end{corollary}

\begin{example}
	{特征多项式的前几项}{}
	\begin{subequations}
		\begin{align}
			a_2&=\frac12\bigkh{\tr(A)^2-\tr(A^2)},\\
			a_3&=\frac16\bigkh{\tr(A)^3-3\tr(A)\tr(A^2)+2\tr(A^3)},
		\end{align}
	\end{subequations}
	更一般地，$a_k$的显性表达式由一个$k$阶行列式给出：
	\begin{equation}
		a_k=\frac{(-)^k}{k!}\begin{vmatrix}
			\tr(A)&k-1\\
			\tr(A^2)&\tr(A)&k-2\\
			\vdots&\vdots&\ddots&\ddots\\
			\vdots&\vdots&\vdots&\ddots&1\\
			\tr(A^k)&\tr(A^{k-1})&\tr(A^{k-2})&\cdots&\tr(A)
		\end{vmatrix}.
	\end{equation}
\end{example}

\section{矩阵对角化}

\begin{definition}
	{相似变换}{similar transformation}
	给定$n$阶矩阵$A$和可逆矩阵$B$，称$B\iv AB$为$A$的相似变换(similar transformation)。
\end{definition}

\begin{corollary}
	相似变换也是一种等价关系。
\end{corollary}

\begin{theorem}{相似变换与特征多项式}{}
	$A$的相似变换$B\iv AB$和$A$有相同的特征多项式。
\end{theorem}
\begin{proof} 
	对下式两边取行列式即证。
	\[
		\lambda I-B\iv AB=\lambda B\iv IB-B\iv AB=B\iv(\lambda I-A)B.
		\qedhere
	\]
\end{proof}

由于对角矩阵有很多简单的性质，考虑相似变换$\Lambda=X\iv AX$，其中$\Lambda$为对角矩阵。
这称为对角化。
显然，不是所有方阵都可以对角化。

\begin{theorem}{可对角化判定}{}
	$n$阶矩阵$A$可对角化$\iff A$有$n$个线性无关的特征向量$x_1,\ldots,x_n$。
	\tcblower
	此时$A=X\Lambda X\iv$，$X$由特征向量给出，对角矩阵$\Lambda$由对应特征值$\lambda_1,\ldots,\lambda_n$给出：
	\begin{equation}
		X=[x_1,\ldots,x_n]
		\quad
	\Lambda=\diag(\lambda_1,\ldots,\lambda_n).
	\end{equation}
\end{theorem}

\begin{proof}
	假设$A$有$n$个线性无关的特征向量$x_1,\ldots,x_n$，则$A$可对角化：
	\[
		AX=[Ax_1,\ldots,Ax_n]=[\lambda_1x_1,\ldots,\lambda_nx_n]=X\Lambda,
	\]
	反过来说，若$A$可对角化为$X\Lambda X\iv$，则$AX=X\Lambda$，即
	\[
		[Ax_1,\ldots,Ax_n]=[\lambda_1x_1,\ldots,\lambda_nx_n],
	\]
	故$x_1,\ldots,x_n$是$A$的特征向量；又由$X$可逆，可得$x_1,\ldots,x_n$线性无关。
\end{proof}

\begin{corollary}
	有$n$个互不相同特征值的$n$阶矩阵$A$可对角化。
\end{corollary}

\paragraph{特征值的重数}

两个线性无关的特征向量的特征值可能相同，或者说，一个特征值可能对应多个线性无关的特征向量，这在量子力学中称为简并(degeneracy)，意味着无法通过单个矩阵的特征值区分两个线性无关的特征值。
对于简并情形，需要引入特征值的重数(multiplicity)的概念。

\newcommand*{\GM}{\mathrm{GM}}
\newcommand*{\AM}{\mathrm{AM}}

\begin{definition}{几何重数和代数重数}{}
	几何重数(geometric multiplicity, GM)：特征值$\lambda_i$对应的线性无关特征向量的最大个数，即特征子空间的维数$\dim\bigkh{\N(\lambda_iI-A)}$。

	代数重数(algebraic multiplicity, AM)：特征值$\lambda_i$作为特征方程$\det(\lambda I-A)=0$的根$\lambda=\lambda_i$的重复次数。
	\[
		\det(\lambda I-A)=\prod_{i=1}^r(\lambda-\lambda_i)^{\AM_i}=0,
	\]
	其中$\lambda_i$是互不相同的根，$\AM_i$是$\lambda_i$的代数重数。
\end{definition}

\begin{corollary}
	代数重数的和$\textstyle\sum_{i=1}^r\AM_i=n$矩阵的阶数。
\end{corollary}

\begin{theorem}{}{GM <= AM}
	$\GM\leqslant\AM.$
\end{theorem}
\begin{proof}
	任取$n$阶矩阵$A$的一个特征值$\lambda_k$，其$\GM_k=\dim\bigkh{\N(\lambda_kI-A)}$，
	\begin{itemize}
		\item 取$\N(\lambda_kI-A)$的一组正交归一基$\{x_1,\ldots,x_{\GM_k}\}$；
		\item 取$\N(\lambda_kI-A)^\perp$的一组正交归一基$\{b_1,\ldots,b_{n-\GM_k}\}$。
	\end{itemize}
	则$\{x_1,\ldots,x_{\GM_k},b_1,\ldots,b_{n-\GM_k}\}$构成$\RR^n$的一组正交归一基，可以此定义$n$阶正交矩阵$P_k$ 
	\[
		P_k=[x_1,\ldots,x_{\GM_k},b_1,\ldots,b_{n-\GM_k}]=:[X_k,B_k],
	\]
	则$AX_k=\lambda_kX_k$，$B_k\tp X_k=0$，故$P_k\iv AP_k$是分块三角的：
	\[
		P_k\iv AP_k=\begin{bmatrix}
			X_k\tp\\B_k\tp
		\end{bmatrix}A\begin{bmatrix}
			X_k&B_k
		\end{bmatrix}=\begin{bmatrix}
			\lambda_kI_{\GM_k}&X_k\tp AB_k\\0&B_k\tp AB_k
		\end{bmatrix},
	\]
	其特征方程为
	\[
		\det(\lambda I-P_k\iv AP_k)=(\lambda-\lambda_k)^{\GM_k}\det(\lambda I-B_k\tp AB_k),
	\]
	显然，其$(\lambda-\lambda_k)$的次数$\AM_k\geq\GM_k$。
	(注意$A$和$P_k\iv AP_k$的特征方程相同)
\end{proof}

\begin{corollary}
	$n$阶矩阵$A$的全部特征值为$\{\lambda_1,\ldots,\lambda_r\}$，$A$可对角化当且仅当
	\[
		\sum_{i=1}^r\dim\bigkh{\N(\lambda_iI-A)}=n,
	\]
	即所有特征值的$\AM_i=\GM_i$。
\end{corollary}

\begin{corollary}
	矩阵不可对角化的来源就在于$\det(\lambda_kI-B_k\tp AB_k)=0$，即行列式提供了新的$(\lambda-\lambda_k)$因子使得$\AM_k>\GM_k$。
\end{corollary}

\begin{theorem}
	{分块对角矩阵的对角化}{}
	分块对角矩阵可对角化$\iff$所有块矩阵均可对角化。
\end{theorem}

\begin{proof}
	考虑只有2个分块对角矩阵$A=\diag(A_1,A_2)$，因为对于$k$块对角矩阵，可令$A_2$是$k-1$块的，通过数学归纳法证明即可。

	一方面，若$A_1,A_2$可对角化，即
	\[
		X_1\iv A_1X_1=\Lambda_1,\quad X_2\iv A_2X_2=\Lambda_2,
	\]
	则令$X=\diag(X_1,X_2),\,\Lambda=\diag(\Lambda_1,\Lambda_2)$可将$A$对角化：
	\[
		X\iv AX=\Lambda;
	\]
	另一方面，若$A$可对角化，任取$A$的一个特征值$\lambda_i$，
	考虑其关于$A,A_1,A_2$的代数重数$\AM,\AM_1,\AM_2$和几何重数$\GM,\GM_1,\GM_2$，由
	\begin{alignat*}{2}
		\det(\lambda I_n-A)&=\det(\lambda I_{n_1}-A_1)\det(\lambda I_{n_2}-A_2)&\implies\AM&=\AM_1+\AM_2;\\
		\rank(\lambda_iI_n-A)&=\rank(\lambda_iI_{n_1}-A_1)+\rank(\lambda_iI_{n_2}-A_2)&\implies\GM&=\GM_1+\GM_2.
	\end{alignat*}
	由$A$可对角化知$\AM=\GM$，而$\AM_1\geq\GM_1,\,\AM_2\geq\GM_2$，
	故$\AM_1=\GM_1,\,\AM_2=\GM_2$，即$A_1,A_2$均可对角化。
\end{proof}

\begin{theorem}{同时对角化}{}
	若$A,B$可对角化，则$A,B$可以同时对角化$\iff A,B$可交换($AB=BA$)。
\end{theorem}

\begin{proof}
	若$A,B$可以同时对角化，即存在可逆矩阵$X$和对角矩阵$\Lambda_A,\Lambda_B$，使得
	\[
		A=X\Lambda_AX\iv,\quad B=X\Lambda_BX\iv,
	\]
	故
	\[
		AB-BA=X(\Lambda_A\Lambda_B-\Lambda_B\Lambda_A)X\iv=0;
	\]
	另一方面，若$AB=BA$，下证$A,B$可同时对角化。
	由$A$可对角化，可知存在$X$使得
	\[
		X\iv AX=\begin{bmatrix}
			\lambda_1I_{n_1}\\ &\ddots\\ &&\lambda_rI_{n_r}
		\end{bmatrix},
	\]
	又由$AB=BA$可得
	\[
		(X\iv AX)(X\iv BX)=(X\iv BX)(X\iv AX),
	\]
	将$X\iv BX$按$X\iv AX$的形状分块，由上式可知$X\iv BX$应是分块对角的：
	\[
		X\iv BX=\begin{bmatrix}
			B_1\\ &\ddots\\ &&B_r
		\end{bmatrix}.
	\]
	由$B$可对角化知$B_i$可对角化，$Y_i\iv B_iY_i=\Lambda_i$。
	令
	\[
		Y=\diag(Y_1,\ldots,Y_r),
		\quad
		\Lambda_B=\diag(\Lambda_1,\ldots,\Lambda_r),
	\]
	则$Y\iv X\iv BXY=\Lambda_B$。
	由此$A,B$可以被$XY$同时对角化。
\end{proof}

\sectionstar{Jordan标准型}

不是所有方阵都可以对角化，如果$n$阶矩阵$A$有$r<n$个线性独立的特征向量，怎么把$A$变成最接近对角矩阵的形式？
其实，任何矩阵都可以通过相似变换变成一种特殊的分块对角矩阵，并且其与对角矩阵只相差了一个幂零矩阵。

\begin{theorem}{Jordan标准型}{Jordan normal form}
	$n$阶矩阵$A$有$r$个线性独立的特征向量$v_1,\ldots,v_r$，对应特征值$\lambda_1,\ldots,\lambda_r$，则存在$n$阶可逆矩阵$P$，使得
	\[
		P^{-1}AP=J=\begin{bmatrix}
			J_1             \\
			 & \ddots       \\
			 &        & J_r
		\end{bmatrix},\quad
		J_i=\begin{bmatrix}
			\lambda_i & 1                              \\
			          & \lambda_i & \ddots             \\
			          &           & \ddots & 1         \\
			          &           &        & \lambda_i
		\end{bmatrix}
	\]
	其中$J_i$称为Jordan块，其主对角线全为$\lambda_i$，主对角线上方的次对角线(若有)全为1，其余元素全为0。
	$J=\diag(J_1,\ldots,J_r)$就是$A$的Jordan标准型(Jordan normal form)。
\end{theorem}

其证明是线性代数的核心。其中一些概念需要等到\chapref{chap:linear mapping}线性映射才会提及。先给出几个概念证明引理。

首先，矩阵$A$不可对角化的原因是存在一个特征值$\lambda_i$的$\AM_i>\GM_i=\dim\bigkh{\N(\lambda_iI-A)}$。
也就是说，特征子空间$\N(\lambda_iI-A)$还是太小了，不能提供足够多线性无关的特征向量。
为此我们需要引入广义特征向量的概念。

\begin{definition}{广义特征向量}{generalized eigenvector}
	给定线性映射$T:V\to V$，若存在$\lambda\in\FF$、正整数$d\in\NN$和$v\in V$且$v\neq 0$，使得
	\[
		(T-\lambda I)^dv=0,
	\]
	则称$v$为$T$的广义特征向量(generalized eigenvector)，使得上式成立的最小正整数$d$称为$v$的幂指数(exponent)。
\end{definition}

\begin{theorem}{}{}
	给定正整数$k$，广义特征方程$(T-\lambda I)^kv=0$有解$\iff\lambda$是$T$的特征值。
\end{theorem}

\begin{proof}
	若$\lambda$是$T$的特征值，则$(T-\lambda I)v=0$，左乘$(T-\lambda I)^{k-1}$即可。
	
	若$(T-\lambda I)^kv=0$有解，则$w=(T-\lambda I)^{k-1}v$满足$(T-\lambda I)w=0$，$\lambda$是$T$的特征值。
\end{proof}

\begin{theorem}{}{}
	% 给定特征值$\lambda$和广义特征向量$v$，
	令$u_i:=(T-\lambda I)^iv$，则$u_0,\ldots,u_{d-1}$线性无关。
\end{theorem}

\begin{proof}
	考虑线性组合$a_0u_0+\cdots+a_{d-1}u_{d-1}=0$，左乘$(T-\lambda I)^{d-1}$可得
	\[
		a_0(T-\lambda I)^{d-1}v+0+\cdots+0=0\implies a_0=0.
	\]
	左乘$(T-\lambda I)^{d-2},(T-\lambda I)^{d-3},\ldots$可得$a_1=\cdots=a_{d-1}=0$，从而$u_0,\ldots,u_{d-1}$线性无关。
\end{proof}

\begin{remark}
	事实上，这一组向量的递推应该反过来：
	首先给出$T$的特征向量$u_{d-1}$，从$u_{d-1}$出发，
	根据$(T-\lambda I)u_j=u_{j+1}$从$u_{j+1}$逆推出$u_j$，
	直到$(T-\lambda I)u_{-1}=u_0$对于$u_{-1}$无解。
	由此得到的$u_{d-1},\ldots,u_0$称为Jordan链，满足
	\[
		u_{d-1}\in\ker(T-\lambda I),\quad
		u_{d-2}\in\ker\bigkh{(T-\lambda I)^2},\quad
		\ldots,\quad
		u_0\notin\ker\bigkh{(T-\lambda I)^d}.
	\]
	并且$u_{d-1},u_{d-2},\ldots,u_1\in\im(T-\lambda I)$，直到$u_0\notin\im(T-\lambda I)$。
\end{remark}

\begin{theorem}{}{}
	$X=\lspan(u_0,\ldots,u_{d-1})$是$T$的不变子空间，即$T(X)\subset X$。
\end{theorem}

\begin{proof}
	由线性无关，$B:=\{u_0,\ldots,u_{d-1}\}$是$X=\lspan(B)$的一组基，考虑$T$在基上的作用：
	\begin{itemize}
		\item $0\leq j< d-1$时，$(T-\lambda I)u_j=u_{j+1}\implies Tu_j=\lambda u_j+u_{j+1}$；
		\item $j=d-1$时，$(T-\lambda I)u_j=0\implies Tu_j=\lambda u_j$；
		\item $j>d-1$时，$u_j=0\implies Tu_j=0$。
	\end{itemize}
	故$\forall u=a_0u_0+\cdots+a_{d-1}u_{d-1}\in X$，有
	\begin{align*}
		Tu&=a_0(\lambda u_0+u_1)+\cdots+a_{d-2}(\lambda u_{d-2}+u_{d-1})+a_{d-1}\lambda u_{d-1}\\
		&=\lambda a_0u_0+(a_0+\lambda a_1)u_1+\cdots+(a_{d-2}+\lambda a_{d-1})u_{d-1}\in X.
		\qedhere
	\end{align*}
\end{proof}

\begin{corollary}
	因为$X$是$T$的不变子空间，我们可以把$T$看成是$X\to X$的线性映射。
	以Jordan链$u_{d-1},\ldots,u_0$作为$B$的基，$T$的表示矩阵为
	\[
		T=\begin{bmatrix}
			\lambda&1\\ &\lambda&\ddots\\ &&\ddots&1\\ &&&\lambda
		\end{bmatrix},
	\]
	这正是\thmref{thm:Jordan normal form} 中定义的Jordan块。
\end{corollary}

\begin{corollary}
	若$v_1,\ldots,v_r$是$T$的广义特征向量，相应的特征值为$\lambda_i$，幂指数为$d_i$，定义
	\[
		u_{i,j}:=(T-\lambda_iI)^jv_i,\quad V_i:=\lspan(u_{i,0},\ldots,u_{i,d_i-1}),
	\]
	则$V_i$是$T$的不变子空间，且$T$在$V_i$上的表示矩阵是Jordan块。
	故$T$在$V_1\oplus\cdots\oplus V_r$上的表示矩阵是分块对角的，且每一块都是Jordan块的形式。

	所以我们只要证明存在这样一组广义特征向量$v_1,\ldots,v_r$使得$V=V_1\oplus\cdots\oplus V_r$就可以证明Jordan标准型的\thmref{thm:Jordan normal form}。
\end{corollary}

\begin{remark}
	假设$\lambda$是$T$的某个特征值。如果$T-\lambda I$可以写成Jordan块的形式，则$T$也可以写成Jordan块的形式。所以以下我们用$T$代替$T-\lambda I$，或者说，考虑有一个特征值是0的线性映射$T$。
\end{remark}

\begin{theorem}{}{}
	设$T^i$的核$K_i:=\ker(T^i)$和像$U_i:=\im(T^i)$，则
	\begin{alignat*}{4}
		K_1&\subset{}&K_2&\subset\cdots&\\
		U_1&\supset{}&U_2&\supset\cdots&
	\end{alignat*}
\end{theorem}

\begin{proof}
	$\forall v\in K_i$，有 
	\[
		T^iv=0\implies T^{i+1}v=0\implies v\in K_{i+1};
	\]
	$\forall u\in U_i$，可表示为$u=T^iv$，则
	\[
		u=T^{i-1}Tv\implies u\in U_{i-1}.
		\qedhere
	\]
\end{proof} 

\begin{corollary}
	若$K_i\neq K_{i+1}$，由$K_i\subset K_{i+1}$可知$\exists v\in K_{i+1}$不能被$K_i$张成，故$\dim(K_i)<\dim(K_{i+1})$；
	又由$\dim(K_i)\leq \dim(V)$有限，故$K_1\subset K_2\subset\cdots$最后会稳定$K_m=K_{m+1}=\cdots$，将最后稳定的空间记为$K$，显然$K$是$T$的不变子空间。

	类似地，$U_1\supset U_2\supset\cdots$最后也会稳定$U_{m'}=U_{m'+1}=\cdots=:U$，易证$U$也是$T$的不变子空间。
\end{corollary}

\begin{theorem}
	{}{}
	$V=K\oplus U$。
\end{theorem}

\begin{proof}
	$\forall u\in K\cap U=K_m\cap U_{m'}$，则$T^mu=0$且存在$v$使得$u=T^{m'}v$，进而$v\in K_{m+m'}=K=K_m$，可得$T^mv=0$。
	而$m,m'$的取值只有下界没有上界，
	固定$m'$，总可以取到$m\leq m'$，则$u=T^{m'-m}T^mv=0$。
	故$K\cap U=\{0\}$。

	又由$\dim(V)=\dim(K_i)+\dim(U_i)=\dim(K)+\dim(U)$，可知$V=K\oplus U$。
\end{proof}

\begin{corollary}
	由$\dim(K)>0$知$\dim(U)<\dim(V)$，根据归纳假设，$T:U\to U$在$U$上可以分解成Jordan标准型。
	下面我们证明$T:K\to K$在$K$上也可以分解成Jordan标准型。
\end{corollary}

\begin{theorem}
	{}{}
	考虑$T:K\to K$的核$K_1'=\ker(T)$和像$U_1'=\im(T)$，
	待补。
\end{theorem}

\begin{proof}
	$\forall v\in K=K_m$均有$T^mv=0$，故$T:K\to K$是幂零的。
\end{proof}

\section{对称矩阵}

\begin{definition}
	{对称矩阵}{symmetric matrix}
	若$S\tp=S$，则称$S$是对称矩阵(symmetric matrix)；
	
	若$A\tp=-A$，则称$A$是反对称矩阵(skew-symmetric/anti-symmetric)。
\end{definition}
\begin{theorem}{对称矩阵的性质·一}{characterist of symmetric matrix I}
	若$S$是一个$n$阶实对称矩阵，则$S$至少有一个实特征值$\lambda$
\end{theorem}
\begin{proof}
	由代数基本定理，对任何矩阵，$S$的特征方程至少会得到一个复特征值$\lambda$，其对应的特征向量为$z$ (一般也是复的)，则$\bar z\tp z>0$。
	\[
		Sz=\lambda z,\quad S\bar z=\bar S\bar z=\overline{Sz}=\bar\lambda\bar z,
	\]
	由$S$的对称的性质，注意到
	\[
		\bar z\tp Sz=\lambda\bar z\tp z=\lambda(\bar z\tp z)\tp=\lambda z\tp\bar z=(Sz)\tp\bar z=z\tp S\bar z=\bar\lambda z\tp\bar z.
	\]
	故$\lambda=\bar\lambda$.
\end{proof}

\begin{corollary}
	由代数基本定理的递归性，可推知$S$的所有特征值都是实数。
\end{corollary}

\begin{theorem}{对称矩阵的性质·二}{characterist of symmetric matrix II}
	$v$是$S$的特征向量，若$w\perp v$，则$Sw\perp v$。
\end{theorem}
\begin{proof}
	
	\[
		(Sw)\tp v=w\tp S\tp v=w\tp Sv=\lambda w\tp v=0.
		\qedhere
	\]
\end{proof}
\begin{theorem}{对称矩阵的性质·三}{characterist of symmetric matrix III}
	若$W$是$\RR^n$的一个线性子空间，且在$S$的作用下稳定，即：
	\[
		\forall w\in W,\enspace Sw\in W,
	\]
	则$W^\perp$也在$S$的作用下稳定：
	\[
		\forall u\in W^\perp,\enspace Su\in W^\perp.
	\]
\end{theorem}
\begin{proof}
	$\forall w\in W,u\in W^\perp$
	\[
		(Su)\tp w=u\tp S\tp w=u\tp(Sw)=0.
		\qedhere
	\]
\end{proof}
\begin{theorem}{谱定理}{spectral theorem}
	对称矩阵$S$总可以被一个正交矩阵$Q$对角化。
\end{theorem}
\begin{proof}
	由\thmref{thm:characterist of symmetric matrix I} 和推论可知$S$至少有一个实特征值$\lambda_1$和实特征向量$q_1$且$q_1\tp q_1=1$，$S$在$q_1$张成的一维线性空间上是稳定的。
	
	由\thmref{thm:characterist of symmetric matrix III} 可知$S$作用在$\C(q_1)^\perp$上也是稳定的，假设$\C(q_1)^\perp$上有一组正交归一基为$\{a_1,\ldots,a_{n-1}\}$，构造矩阵$X_1=[q_1,a_1,\ldots,a_{n-1}]$，且$X_1$是正交的$X_1\tp X_1=I$，
	\[
		X_1\tp SX_1=X_1\tp[\lambda q_1,Sa_1,\ldots,Sa_{n-1}]=\begin{bmatrix}
			\lambda_1\\ &S_1
		\end{bmatrix}.
	\]
	$S_1$是一个$(n-1)$阶方阵，且$(S_1)_{ij}=a_i\tp Sa_j$的，显然它也是对称的。
	
	重复上述步骤，直到用$S$的特征向量构造出$\RR^n$的一组正交归一基：
	
	\noindent
	对$S_1$可构造$(n-1)$阶的正交矩阵$X_2$，使得
	\[
		X_2\tp S_1X_2=\begin{bmatrix}
			\lambda_2\\ &S_2
		\end{bmatrix},
	\]
	其中$S_2$是一个$(n-2)$阶对称方阵。从而
	\[
		\begin{bmatrix}
			1\\ &X_2\tp
		\end{bmatrix}X_1\tp SX_1\begin{bmatrix}
			1\\ &X_2
		\end{bmatrix}=\begin{bmatrix}
			\lambda_1\\ &\lambda_2\\ &&S_2
		\end{bmatrix}.
	\]
	$Q_2:=X_1\diag(1, X_2)$也是正交的……最终有
	\[
		Q_n\tp SQ_n=\begin{bmatrix}
			\lambda_1\\ &\ddots\\ &&\lambda_n
		\end{bmatrix}.
	\]
	$Q_n$也是正交的。
\end{proof}

\begin{remark}
	对角化对称矩阵$S$的正交矩阵$Q$可被构造：
	\begin{compactitem}
		\item 若$S$的特征值互不相同，对应的归一特征向量$q_i$两两正交，可选$Q=[q_1,\ldots,q_n]$；
		\item 若$S$的特征值有重复，取$\{q_i\}$为相应特征子空间的正交基。
	\end{compactitem}
\end{remark}

\section{正定矩阵}

\begin{definition}{二次型}{quadratic form}
	二次型(quadratic form)是形如$x\tp Sx$的二次多项式，其中$S$是实对称矩阵。
\end{definition}
\begin{definition}{正定矩阵}{positive definite matrix}
	给定对称矩阵$S$，如果$\forall x\neq 0$，二次型$x\tp Sx>0$，则称$S$是正定的(positive definite)。
\end{definition}
\begin{theorem}{正定矩阵的判定}{determination of positive definite matrix}
	对于对称矩阵$S$，下述命题是等价的：
	\begin{compactenum}
		\item $\forall x\neq 0$，二次型$x\tp Sx>0$；
		\item $S$的所有$n$个特征值都是正的；
		\item $S$可以只通过换行和倍加后得到$n$个正的主元；
		\item $S$的所有左上行列式（前$i$行$i$列子矩阵的行列式）均$>0$；
		\item 存在$A$列之间线性无关，使得$S=A\tp A$。
	\end{compactenum}
\end{theorem}
\begin{proof}
	$1\implies 2$：$S$对称，则$\Lambda=Q\tp SQ$
	\[
		\lambda_i=e_i\tp \Lambda e_i=e_i\tp Q\tp SQe_i=(Qe_i)\tp S(Qe_i)>0.
	\]
	$2\implies 1$：$S$的所有$n$个特征值都是正的，故
	\[
		x\tp Sx=x\tp Q\Lambda Q\tp x=\sum_{i=1}^n\lambda_i(Q\tp x)^2_i>0.
	\]
	$5\implies 1$：$A$列之间线性无关，故$\forall x\neq 0,\enspace Ax\neq 0$
	\[
		x\tp Sx=x\tp A\tp Ax=(Ax)\tp(Ax)>0.
	\]
	$1\implies 5$：$S$正定，故
	\[
		S=Q\Lambda Q\tp=Q\begin{bmatrix}
			\sqrt{\lambda_1}\\ &\ddots\\ &&\sqrt{\lambda_n}
		\end{bmatrix}\begin{bmatrix}
			\sqrt{\lambda_1}\\ &\ddots\\ &&\sqrt{\lambda_n}
		\end{bmatrix}Q\tp=:A\tp A.
	\]
	$3\implies 4$：行倍加不改变所有左上行列式，$S$做行倍加得到上三角矩阵$U$，其$i\times i$的左上行列式就是前$i$个主元的乘积，所以$>0$。\\
	$4\implies 3$：$U$的左上行列式都$>0$，所以前$i$个主元乘积都$>0$，所以主元全正。\\
	$3\implies 5$：$S=LDU$，由$S$对称且$LDU$分解唯一可知$L=U\tp$，又主元全正，故
	\[
		S=U\tp DU=U\tp\begin{bmatrix}
			\sqrt{a_1}\\ &\ddots\\ &&\sqrt{a_n}
		\end{bmatrix}\begin{bmatrix}
			\sqrt{a_1}\\ &\ddots\\ &&\sqrt{a_n}
		\end{bmatrix}U=:A\tp A.
	\]
	$5\implies 3$：$A$列之间线性无关，故$A=QR$
	\[
		A\tp A=R\tp Q\tp QR=R\tp R=LDU.
		\qedhere
	\]
\end{proof}
\begin{definition}{半正定矩阵}{positive semi-definite matrix}
	如果$\forall x\neq 0$，二次型$x\tp Sx\geqslant 0$，则称$S$是半正定的(positive semi-definite)。
\end{definition}
\begin{theorem}{半正定但非正定矩阵的判定}{determination of positive semi-but-not definite matrix}
	\begin{compactenum}
		\item $S$的最小特征值是0；
		\item 存在$A$列之间线性相关，使得$S=A\tp A$。
	\end{compactenum}
\end{theorem}
\begin{corollary}
	半正定但非正定矩阵的行列式为0。
\end{corollary}

\begin{theorem}
	{Cholesky分解}{Cholesky decomposition}
	正定矩阵$A$可以分解为
	\begin{equation}
		A=LL\tp,
	\end{equation}
	其中$L$是对角元为正的下三角矩阵，这称为Cholesky分解。
\end{theorem}


